---
apiVersion: "apiextensions.k8s.io/v1beta1"
kind: "CustomResourceDefinition"
metadata:
  annotations:
    entando.org/controller-image: "entando-k8s-database-service-controller"
    entando.org/supported-capabilities: "mysql.dbms,oracle.dbms,postgresql.dbms,dbms"
  generation: 1
  labels:
    entando.org/crd-of-interest: "EntandoDatabaseService"
  name: "entandodatabaseservices.entando.org"
  resourceVersion: "9938844"
  uid: "353db5ec-0b04-413b-8bce-52ed79008934"
spec:
  additionalPrinterColumns:
  - JSONPath: ".status.phase"
    name: "Phase"
    type: "string"
  - JSONPath: ".metadata.creationTimestamp"
    name: "Age"
    type: "date"
  - JSONPath: ".spec.dbms"
    name: "DBMS"
    type: "string"
  - JSONPath: ".spec.replicas"
    name: "Replicas"
    type: "integer"
  group: "entando.org"
  names:
    kind: "EntandoDatabaseService"
    plural: "entandodatabaseservices"
    shortNames:
    - "eds"
  scope: "Namespaced"
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        spec:
          properties:
            replicas:
              description: "The number of pods that should participate in the cluster\
                \ of Database servers. For advanced use cases only."
              maximum: 10.0
              minimum: 1.0
              type: "integer"
            dbms:
              description: "The database management system (DBMS) to make available\
                \ as a Kubernetes Service. Can be oracle, mysql or postgresql. Only\
                \ 1 replica of the container is supported if embedded is selected.\
                \ If Oracle is selected it must be created manually, the operator\
                \ does not deploy Oracle instances. See [here](https://dev.entando.org/v6.3/docs/concepts/operator-intro.html#database-deployment)\
                \ for how the operator will create and configure the DBMS.\n"
              pattern: "^(mysql|oracle|postgresql)$"
              type: "string"
            storageClass:
              description: "The name of the StorageClass to use for PersistentVolumeClaims\
                \ created for this EntandoDatabaseService\n"
              type: "string"
            createDeployment:
              description: "When this property is 'true', the Entando Operator will\
                \ create a Kubernetes Deployment using the standard Docker image for\
                \ the DBMS specified. It will also create a Kubernetes Service to\
                \ allow other Pods to connect to the resulting database service. When\
                \ this property is 'false', the Entando Operator will only create\
                \ a Kubernetes Service that is then configured to point to the external\
                \ database service as specified in the 'host' and 'port' properties.\n"
              type: "boolean"
            host:
              description: "When 'spec.createDeployment' is false, this field is required\
                \ to create a Service  that points to an external database server\
                \ using the value of the host property.\n"
              pattern: "^([A-Za-z0-9-]{1,63}\\.)*[[A-Za-z0-9-]{1,63}$"
              type: "string"
            port:
              description: "When 'spec.createDeployment' is false, this field is required\
                \ to create a Service that points to an external database service\
                \ running on the port specified on this property. If no value is provided,\
                \ it defaults to the default port of the DBMS in question.\n"
              type: "integer"
            database:
              description: "If 'spec.createDeployment' is false, this is the name\
                \ of the database that this database service will connect to. If 'spec.createDeployment'\
                \ is true, and PostgreSQL is being used, it will create the database\
                \ on PostgreSQL. This property has no effect on MySQL.\n"
              type: "string"
            tablespace:
              description: "Only used in Oracle to specify the tablespace that tables\
                \ should be created on.\n"
              type: "string"
            secretName:
              description: "The name of a Kubernetes Secret that contains the username\
                \ and password of a user on the database server that has superuser\
                \ permissions.\n"
              type: "string"
            jdbcParameters:
              description: "A map of name/value pairs that will be appended to the\
                \ connection string to the database in questions.\n"
              type: "object"
            serviceAccountToUse:
              description: "The Kubernetes ServiceAccount in the Namespace of the\
                \ EntandoDatabaseService that is to be used for the Pods hosting the\
                \ database service. Can be left empty for most situations, as the\
                \ database container doesn't make direct use of Kubernetes resources.\n"
              pattern: "^([a-z])+([a-z0-9-\\.])*[a-z0-9]$"
              type: "string"
            environmentVariables:
              description: "A list of environment variable following the standard\
                \ structure of Kubernetes Environment Variables\n"
              items:
                properties:
                  name:
                    type: "string"
                  value:
                    type: "string"
                  valueFrom:
                    properties:
                      configMapKeyRef:
                        properties:
                          name:
                            description: "Name of a ConfigMap in the same namespace\
                              \ as the EntandoDatabaseService"
                            type: "string"
                          key:
                            description: "Key of the ConfigMap entry in that holds\
                              \ the value to be used for the EnvironmentVariable"
                            type: "string"
                        type: "object"
                      fieldRef:
                        properties:
                          apiVersion:
                            description: "Version of the API to used for the field\
                              \ expression"
                            type: "string"
                          fieldPath:
                            description: "Full expression starting from the Pod resource"
                            type: "string"
                        type: "object"
                      resourceFieldRef:
                        properties:
                          containerName:
                            description: "Name of the container to use"
                            type: "string"
                          resource:
                            description: "Name of the resource to use"
                            type: "string"
                        type: "object"
                      secretKeyRef:
                        properties:
                          name:
                            description: "Name of a Secret in the same namespace as\
                              \ the EntandoDatabaseService"
                            type: "string"
                          key:
                            description: "Key of the Secret entry in that holds the\
                              \ value to be used for the EnvironmentVariable"
                            type: "string"
                        type: "object"
                    type: "object"
                type: "object"
              type: "array"
            resourceRequirements:
              description: "The projected resource requirements of the given database\
                \ deployment. Specifies the limits that the container is expected\
                \ to respect, and the size of requests that will be initiated on behalf\
                \ of the container. When omitted our known defaults will be applied.\n"
              properties:
                storageRequest:
                  description: "Size of persistent storage that will be requested\
                    \ when deployed. Can be omitted. Supported only by a small subset\
                    \ of Kubernetes storage providers.\n"
                  type: "string"
                storageLimit:
                  description: "The maximum amount of persistent storage require by\
                    \ the database server.  Limits and requests for memory are measured\
                    \ in bytes. You can express storage as a plain integer using one\
                    \ of these suffixes: T, G, M, K. You can also use the power-of-two\
                    \ equivalents: Ti, Gi, Mi, Ki.\n"
                  type: "string"
                memoryRequest:
                  description: "The amount of memory that will be requested when deployed.\
                    \ A pod will only be deployed to a node that has this amount of\
                    \ memory available. You can  express memory as a plain integer\
                    \ using one of these suffixes: T, G, M, K. You can also use the\
                    \ power-of-two equivalents: Ti, Gi, Mi, Ki.\n"
                  type: "string"
                memoryLimit:
                  description: "The maximum amount of memory that the container is\
                    \ expected to use. Kubernetes will limit the amount of memory\
                    \ to the container the to amount specified. You can  express memory\
                    \ as a plain integer using one of these suffixes: T, G, M, K.\
                    \ You can also use the power-of-two equivalents: Ti, Gi, Mi, Ki.\n"
                  type: "string"
                cpuRequest:
                  description: "The amount of CPU units that will be requested from\
                    \ a node at deployment time. A pod will only be deployed to a\
                    \ node if the node has this amount of CPU units available. Supports\
                    \ decimal numbers, or alternatively the suffix 'm' can be used\
                    \ to specify a millicore. Precision lower than 1m is not supported.\n"
                  type: "string"
                cpuLimit:
                  description: "The maximum amount of CPU units that will be required\
                    \ by the container.Supports decimal numbers, or alternatively\
                    \ the suffix 'm' can be used to specify a millicore. Precision\
                    \ lower than 1m is not supported.\n"
                  type: "string"
              type: "object"
          type: "object"
        status:
          properties:
            observedGeneration:
              type: "number"
            phase:
              type: "string"
            serverStatuses:
              type: "object"
              x-kubernetes-preserve-unknown-fields: true
          type: "object"
  versions:
  - name: "v1"
    served: true
    storage: true
